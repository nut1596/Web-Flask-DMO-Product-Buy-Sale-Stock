{% extends "base.html" %}
{% block content %}

<!-- üî• HERO TITLE -->
<div class="text-center mb-12">
    <h1 class="text-4xl md:text-5xl font-bold mb-4">
        ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πå‡∏î
    </h1>
    <p class="text-gray-400">
        ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ ‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ö‡∏ö‡∏°‡∏∑‡∏≠‡∏≠‡∏≤‡∏ä‡∏µ‡∏û
    </p>
</div>


<!-- üîç FILTER PANEL (Glass Effect) -->
<div class="bg-white/5 backdrop-blur-md border border-gray-800 rounded-2xl p-6 mb-10 shadow-lg">

    <form method="GET" class="grid grid-cols-1 md:grid-cols-4 gap-4">

        <input type="text"
               name="search"
               value="{{ search or '' }}"
               placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤..."
               class="input input-bordered bg-black/40 border-gray-700 focus:border-cyan-500 w-full" />

        <select name="category"
                class="select select-bordered bg-black/40 border-gray-700 focus:border-purple-500 w-full">
            <option value="">‡∏ó‡∏∏‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</option>
            {% for c in categories %}
            <option value="{{ c.id }}"
                {% if selected_category and selected_category|int == c.id %}
                    selected
                {% endif %}>
                {{ c.name }}
            </option>
            {% endfor %}
        </select>

        <select name="sort"
                class="select select-bordered bg-black/40 border-gray-700 focus:border-pink-500 w-full">
            <option value="">‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏õ‡∏Å‡∏ï‡∏¥</option>
            <option value="price_asc" {% if sort == 'price_asc' %}selected{% endif %}>
                ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡πà‡∏≥ ‚Üí ‡∏™‡∏π‡∏á
            </option>
            <option value="price_desc" {% if sort == 'price_desc' %}selected{% endif %}>
                ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏π‡∏á ‚Üí ‡∏ï‡πà‡∏≥
            </option>
        </select>

        <button class="btn bg-cyan-500 hover:bg-cyan-400 text-black border-none w-full">
            ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
        </button>

    </form>
</div>


<!-- üõç PRODUCT GRID -->
<div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-8">

    {% for product in products %}
    <div class="card bg-black border border-gray-800 shadow-xl hover:shadow-cyan-500/20 hover:-translate-y-2 transition duration-300">

        <figure>
            <img src="{{ url_for('static', filename='images/' + product.image) }}"
                 class="h-48 w-full object-cover">
        </figure>

        <div class="card-body">

            <h2 class="card-title text-white">
                {{ product.name }}
            </h2>

            <p class="text-xl font-bold text-cyan-400">
                {{ product.price }} ‡∏ö‡∏≤‡∏ó
            </p>

            <!-- üì¶ STOCK STATUS -->
            {% if product.stock == 0 %}
                <div class="badge bg-red-600 border-none">
                    ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏´‡∏°‡∏î
                </div>
            {% elif product.stock <= 3 %}
                <div class="badge bg-yellow-500 text-black border-none">
                    ‡πÄ‡∏´‡∏•‡∏∑‡∏≠ {{ product.stock }} ‡∏ä‡∏¥‡πâ‡∏ô
                </div>
            {% else %}
                <div class="badge bg-green-600 border-none">
                    ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏à‡∏≥‡∏´‡∏ô‡πà‡∏≤‡∏¢
                </div>
            {% endif %}

            <!-- üõí BUTTON -->
            <div class="card-actions justify-end mt-4">
                {% if product.stock > 0 %}
                    <a href="{{ url_for('main.add_to_cart', product_id=product.id) }}"
                       class="btn bg-purple-600 hover:bg-purple-500 border-none btn-sm">
                        ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤
                    </a>
                {% else %}
                    <button class="btn btn-disabled btn-sm">
                        ‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß
                    </button>
                {% endif %}
            </div>

        </div>
    </div>
    {% endfor %}

</div>


<!-- üìÑ PAGINATION -->
{% if pagination.pages > 1 %}
<div class="flex justify-center mt-12">
    <div class="join">

        {% if pagination.has_prev %}
        <a class="join-item btn bg-gray-800 border-gray-700 hover:bg-gray-700"
           href="{{ url_for('main.home',
                            page=pagination.prev_num,
                            search=search,
                            category=selected_category,
                            sort=sort) }}">
           ¬´
        </a>
        {% endif %}

        {% for p in range(1, pagination.pages + 1) %}
        <a class="join-item btn 
           {% if p == pagination.page %}
              bg-cyan-500 text-black
           {% else %}
              bg-gray-800 hover:bg-gray-700
           {% endif %}"
           href="{{ url_for('main.home',
                            page=p,
                            search=search,
                            category=selected_category,
                            sort=sort) }}">
           {{ p }}
        </a>
        {% endfor %}

        {% if pagination.has_next %}
        <a class="join-item btn bg-gray-800 border-gray-700 hover:bg-gray-700"
           href="{{ url_for('main.home',
                            page=pagination.next_num,
                            search=search,
                            category=selected_category,
                            sort=sort) }}">
           ¬ª
        </a>
        {% endif %}

    </div>
</div>
{% endif %}

{% endblock %}